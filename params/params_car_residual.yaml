env:
  start: [0.0, 1.95, 0.0, 14.0] # x,y,theta,v
  goal_state: [70.0, 1.95, 0.0, 0.0]
  dynamics: 'bicycle_Bdx' # "pendulum"
  params: 
    lf: 1.105 #0.55 #1.105, 0.275
    lr: 1.738 #0.85 #1.738, 0.425
  prior_dyn_meas: True 
  train_data_has_derivatives: False
  use_model_without_derivatives: False
  n_data_x: 5
  n_data_u: 9
  # ellipses:
    # n1 : [26, 5.0, 9.0, 1.0, 5.67]  # x0, y0, a^2, b^2, f equation of ellipse: (x-x0)^2/a^2 + (y-y0)^2/b^2 = f
    # n1 : [15, 1.0, 9.0, 1.0, 5.67]
    # n1 : [20, 1.0, 6.0, 9.0, 12.67]
    # n3 : [42, 1.0, 9.0, 1.0, 5.67]
    # n4 : [58, 5.0, 9.0, 1.0, 5.67]
    # n1 : [24, 4.5, 9.0, 1.0, 5.67]  # x0, y0, a, b, f equation of ellipse: (x-x0)^2/a^2 + (y-y0)^2/b^2 = f
    # n2 : [10, 1.5, 9.0, 1.0, 5.67]
    # n3 : [38, 1.5, 9.0, 1.0, 5.67]
    # n4 : [52, 4.5, 9.0, 1.0, 5.67]

agent:
  g_dim :
    ny : 3
    nx : 1
    nu : 1
  dim :
    ny : 3
    nx : 4
    nu : 2
  Dyn_gp_lengthscale :
    # both : [[[0.21266, 0.56651, 1.05719]], [[2.2651, 4.6306, 7.6728]], [[20.9180, 6.1829, 3.7340]]]
    # both : [[[ 3.5447,  3.7175]], [[ 3.9424,  3.2711]], [[50.3278,  3.3770]]]
    both : [[[1.492, 1.508]], [[1.7, 1.15]], [[5.22931,  1.9544]]]
  Dyn_gp_noise : 1.0e-8 # zero noise (modulo GP jitter below)
  Dyn_gp_outputscale : 
    y1 : 0.1040 #0.3040 #0.75  #0.65
    y2 : 0.1071 #0.3071 #0.65 #0.455, noise multiplier 3.0e-7 results in smooth trajectories
    both : [0.065, 0.075, 0.01] #[0.0357, 0.1621, 0.0054] #[0.223, 0.0847, 0.0082]  #[0.123, 0.0447, 0.0042]
  Dyn_gp_task_noises : 
    val : [1.4, 1.48, 0.515]
    multiplier : 1.0e-8                     #1.0e-5 Low noise value make it crazy fast
  Dyn_gp_beta : 3.0 # 1.5
  mean_shift_val : 2
  cov_module: 'Matern'     #'Matern', Sq_exp
  num_dyn_samples: 1     
  mean_as_dyn_sample: False
  true_dyn_as_sample: True        # This is for debugging, set num_dyn_samples to 1
  Dyn_gp_jitter: 1.0e-20
  Dyn_gp_variance_is_zero: -1.0 # -1 : deactivated
  Dyn_gp_min_data_dist: -1.0 # -1 : deactivated
  tight:
    use: False
    dyn_eps: 0.0002 # GT: 0.0002, 5.7e7: 0.00015
    Lipschitz: 1.0016 #1.0304 #1.0344 #1.021 #1.0344 #1.0019 #1.0884 #1.0061 #1.00001
    w_bound: 0.000001
  shift_soln: False
  feedback: 
    use: True
    v_min : [-1000, -1000] # Minimum control input
    v_max : [1000, 1000] 
  input_generation: True

visu:
  show: False

common:
  use_cuda : True
  num_MPC_itrs : 1
  dynamics_rejection: False

optimizer:
  H : 50 # horizon
  u_min : [-0.6, -2] # Minimum control input
  u_max : [0.6, 2] 
  # u_min : [-30, -30] # Minimum control input
  # u_max : [30, 30] 
  x_min : [-2.14, -2.0, -1.0, 9] # Minimum state value
  x_max : [ 70, 16.0, 1.0, 16] # x,y,v,theta,theta_dot
  # x_max : [ 70, 6.0, 1.14, 10] # x,y,v,theta,theta_dot
  linear_solver : 'ma57' #
  oracle:
    max_sqp_iter: 10
    tol_nlp: 1.0e-6
  SEMPC:
    max_sqp_iter: 150
    tol_nlp: 1.0e-4 
  order: 2
  dt: 0.06 # 0.010
  w: 40
  # Qx: [2, 36, 0.07, 0.005] # n=40 [2, 32, 0.1, 0.05], n=20 [2, 32, 0.07, 0.005]
  # Qx: [2, 30, 0.07, 0.5] # n=40 [2, 32, 0.1, 0.05], n=20 [2, 32, 0.07, 0.005]
  Qx: [2, 10, 0.07, 0.5]
  Qu: [0.5, 0.2]
  # Qu: [5, 0.5]
  cost: "expected"
  options: {
    levenberg_marquardt: 30.0
  }
  terminal_tightening:
    x_tight: [0.1, 0.1, 0.2, 0.1] #
    u_tight: [0.1, 0.1]
    # 0.985, L = 0.9941
    # P: [[ 0.16363344, -0.01136337,  0.04407626,  0.18140036],
    #    [-0.01136337,  0.13784163,  0.21306139, -0.06179032],
    #    [ 0.04407626,  0.21306139,  3.46093752,  0.01662453],
    #    [ 0.18140036, -0.06179032,  0.01662453,  0.34718358]]
    # K: [[-0.02996426, -0.07803062, -1.12587703, -0.00206327],
    #    [-0.79830366,  0.2773424 , -0.0348494 , -1.7452992 ]]
    # 0.988, L = 0.997
    # P: [[ 0.11035586, -0.01034747,  0.03526285,  0.16066056],
    #    [-0.01034747,  0.08538689,  0.14968234, -0.05421246],
    #    [ 0.03526285,  0.14968234,  3.1136615 ,  0.0224437 ],
    #    [ 0.16066056, -0.05421246,  0.0224437 ,  0.38700987]]
    # K: [[-2.16348982e-02, -5.84399534e-02, -1.07827378e+00,
    #      7.64188543e-05],
    #    [-4.34897600e-01,  1.44163109e-01, -1.63329238e-02,
    #     -1.22078762e+00]]
    # # 0.99, L = 0.9989
    # P: [[ 0.05221207, -0.00562596,  0.02300766,  0.08954636],
    #    [-0.00562596,  0.0380061 ,  0.09181979, -0.02961861],
    #    [ 0.02300766,  0.09181979,  2.34023191,  0.02305224],
    #    [ 0.08954636, -0.02961861,  0.02305224,  0.25003454]]
    # K: [[-1.60682853e-02, -4.16389754e-02, -9.47616904e-01,
    #      2.06371556e-03],
    #    [-2.97245897e-01,  1.00938917e-01, -9.65459952e-04,
    #     -9.78494243e-01]]
    # FG, L = 1.0037, rho 0.99
    # P: [[ 3.02595580e-01, -9.58984813e-04, -8.74883319e-04,
    #      3.56876659e-01],
    #    [-9.58984813e-04,  2.71775578e-01,  2.14931050e-01,
    #     -1.11817860e-02],
    #    [-8.74883319e-04,  2.14931050e-01,  4.37576254e+00,
    #      1.31702217e-02],
    #    [ 3.56876659e-01, -1.11817860e-02,  1.31702217e-02,
    #      7.83182988e-01]]
    # K: [[-2.63746809e-03, -7.12370918e-02, -1.28849794e+00,
    #     -6.52709069e-04],
    #    [-7.47740871e-01,  2.35772996e-02, -5.52432218e-03,
    #     -1.76640786e+00]]
    # FG, L = 1.0024, rho 0.992
    # P: [[ 2.07117243e-01, -4.22909292e-04,  1.83262025e-03,
    #      2.75272343e-01],
    #    [-4.22909292e-04,  1.86496275e-01,  1.83582711e-01,
    #     -8.27712744e-03],
    #    [ 1.83262025e-03,  1.83582711e-01,  4.26616451e+00,
    #      1.78026080e-02],
    #    [ 2.75272343e-01, -8.27712744e-03,  1.78026080e-02,
    #      6.85097652e-01]]
    # K: [[-2.33334644e-03, -6.11037273e-02, -1.27292872e+00,
    #     -6.65341866e-04],
    #    [-6.23039110e-01,  1.95771407e-02, -4.49531684e-03,
    #     -1.65281792e+00]]
    # Vrange l = 1.0016, rho 0.992
    P: [[ 4.50618781e-01,  2.10101725e-05, -3.75707034e-03,
         5.38117374e-01],
       [ 2.10101725e-05,  4.28592943e-01,  2.64200457e-01,
        -1.65581498e-02],
       [-3.75707034e-03,  2.64200457e-01,  4.90922812e+00,
         1.45000289e-02],
       [ 5.38117374e-01, -1.65581498e-02,  1.45000289e-02,
         1.20198534e+00]]
    K: [[-2.96060719e-03, -8.05127934e-02, -1.34526882e+00,
        -8.17447260e-04],
       [-9.35534702e-01,  2.97777988e-02, -3.23316428e-03,
        -2.19242872e+00]]
    # FG L = 1.00024, rho 0.995
    # P: [[ 1.23480263e-01, -5.18569682e-06,  2.05256593e-03,
    #      2.01684995e-01],
    #    [-5.18569682e-06,  1.09848229e-01,  1.42679100e-01,
    #     -5.69093000e-03],
    #    [ 2.05256593e-03,  1.42679100e-01,  4.24715254e+00,
    #      1.56916939e-02],
    #    [ 2.01684995e-01, -5.69093000e-03,  1.56916939e-02,
    #      6.28964440e-01]]
    # K: [[-1.67383173e-03, -4.55346495e-02, -1.25269658e+00,
    #     -2.64388563e-05],
    #    [-4.88240566e-01,  1.52481400e-02, -1.57727889e-03,
    #     -1.58518623e+00]]
    # FG , L = 1.00008, rho 0.999
    # P : [[ 6.92207108e-03, -8.46565524e-05, -1.54944818e-04,
    #      2.23402125e-02],
    #    [-8.46565524e-05,  4.70471937e-03,  1.96145132e-02,
    #     -7.76341330e-04],
    #    [-1.54944818e-04,  1.96145132e-02,  2.48979239e+00,
    #      3.75430205e-03],
    #    [ 2.23402125e-02, -7.76341330e-04,  3.75430205e-03,
    #      1.86135303e-01]]
    # K : [[-3.48957313e-04, -8.44790673e-03, -1.02907666e+00,
    #     -2.17469062e-05],
    #    [-1.01849069e-01,  3.61970269e-03, -7.38471561e-03,
    #     -8.62804898e-01]] 
    # # 0.993, L = 0.999
    # P: [[ 0.01921061, -0.00224437,  0.01218653,  0.04275369],
    #    [-0.00224437,  0.01381027,  0.04939539, -0.01434576],
    #    [ 0.01218653,  0.04939539,  1.70971617,  0.01366693],
    #    [ 0.04275369, -0.01434576,  0.01366693,  0.15508264]]
    # K: [[-0.01089559, -0.02683152, -0.83880844,  0.00161515],
    #    [-0.18480651,  0.06338656, -0.00254316, -0.77425089]]
    # P: [[ 5.42489653e-05, -6.56314699e-07,  8.62483360e-05,
    #      1.75371552e-04],
    #    [-6.56314699e-07,  5.10795491e-05,  9.11688224e-04,
    #     -2.66565882e-05],
    #    [ 8.62483360e-05,  9.11688224e-04,  1.58809436e+00,
    #      6.66522467e-03],
    #    [ 1.75371552e-04, -2.66565882e-05,  6.66522467e-03,
    #      1.97094998e-02]]
    # K: [[-8.70325634e-05, -5.80935002e-04, -8.59414487e-01,
    #      2.81945619e-03],
    #    [-2.19896176e-03,  3.74071269e-04, -5.67735217e-04,
    #     -2.80473875e-01]]
    # # # L = 1.0019
    # P: [[ 0.70988411, -0.02494711,  0.02610074,  0.63262496],
    #    [-0.02494711,  0.56067853,  0.31748148, -0.10292962],
    #    [ 0.02610074,  0.31748148,  4.51384718,  0.02323581],
    #    [ 0.63262496, -0.10292962,  0.02323581,  0.97763984]]
    # K: [[-1.82496163e-02, -1.03196267e-01, -1.28125637e+00,
    #     -7.48757190e-04],
    #    [-1.10291625e+00,  1.81061257e-01, -1.72473380e-02,
    #     -1.95592037e+00]]
    # L = 1.0061
    # P : [[ 2.73090037, -0.17303723,  0.02192368,  1.80074205],
    #    [-0.17303723,  1.69495865,  0.60042077, -0.29039199],
    #    [ 0.02192368,  0.60042077,  4.82477838,  0.02067602],
    #    [ 1.80074205, -0.29039199,  0.02067602,  1.82391319]]
    # K : [[-3.44023733e-02, -1.99638418e-01, -1.30878799e+00,
    #     -8.15804048e-04],
    #    [-2.08337563e+00,  3.38650820e-01, -2.87616187e-02,
    #     -2.61209329e+00]]
    # tilde_eps_49 = [1.65915914 1.68434298 1.08780602 1.84099779 1.38079175 4.61222586 5.30076991]
    # L = 1.0884
    # P : [[ 2.74157326e+01, -2.42938369e+00, -1.91044868e-01,
    #      9.45462671e+00],
    #    [-2.42938369e+00,  1.26932905e+01,  1.32804704e+00,
    #     -1.52345386e+00],
    #    [-1.91044868e-01,  1.32804704e+00,  5.66188806e+00,
    #      5.48373925e-03],
    #    [ 9.45462671e+00, -1.52345386e+00,  5.48373925e-03,
    #      5.16297189e+00]]
    # K : [[-6.66339035e-02, -3.82952054e-01, -1.41730559e+00,
    #     -1.04700192e-03],
    #    [-5.50331049e+00,  8.98900120e-01, -5.81585865e-02,
    #     -4.27749547e+00]] 
    # tilde_eps_49 = [ 1.75863574  1.61763311  2.37838638  4.09307979  3.33287335 11.30324305 31.17850812]

experiment:
  name: "DEMPC" #
  generate_regret_plot : True
  folder: "car"
  rnd_seed: 
    use: True
    value: 123456

    # array([[ 4.18292227e-02,  1.99853867e-04,  5.78857959e-03,
    #      3.21057040e-02],
    #    [ 1.99853867e-04,  5.96432944e-03,  7.78279091e-03,
    #     -7.49461847e-04],
    #    [ 5.78857959e-03,  7.78279091e-03,  1.57638148e+00,
    #      1.43236896e-02],
    #    [ 3.21057040e-02, -7.49461847e-04,  1.43236896e-02,
    #      1.37260290e-01]]),
    # array([[-0.00664596, -0.005348  , -0.75699781, -0.00216248],
    #    [-0.28551   ,  0.00543966,  0.00649901, -0.69907884]])]